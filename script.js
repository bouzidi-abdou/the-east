document.addEventListener('DOMContentLoaded', () => {

    // =========================================================
    // 1. ุชุญุฏูุซ ุนุฏุฏ ุงููุงุนุจูู (Simulation)
    // =========================================================
    function fetchPlayerCount() {
        const minPlayers = 50;
        const maxPlayers = 500;
        const playerCount = Math.floor(Math.random() * (maxPlayers - minPlayers + 1)) + minPlayers;
        const playerCountElement = document.getElementById('player-count');
        if (playerCountElement) {
            playerCountElement.textContent = playerCount;
        }
    }
    fetchPlayerCount();
    setInterval(fetchPlayerCount, 30000); // ุชุญุฏูุซ ูู 30 ุซุงููุฉ

    // =========================================================
    // 2. ุงูุชููู ุงูุณูุณ ุจูู ุฃูุณุงู ุงูุตูุญุฉ (Smooth Scrolling)
    // =========================================================
    document.querySelectorAll('nav ul li a').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetSection = document.querySelector(this.getAttribute('href'));
            if (targetSection) targetSection.scrollIntoView({ behavior: 'smooth' });
            document.querySelectorAll('nav ul li a').forEach(link => link.classList.remove('active'));
            this.classList.add('active');
        });
    });

    // =========================================================
    // 3. ูุณุฎ IP ุงูุณูุฑูุฑ
    // =========================================================
    document.querySelectorAll('.btn-copy-ip').forEach(button => {
        button.addEventListener('click', function () {
            const ipAddress = this.getAttribute('data-ip');
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(ipAddress).then(() => {
                    this.textContent = 'ุชู ุงููุณุฎ! โ';
                    setTimeout(() => { this.innerHTML = 'Soon... <i class="fas fa-copy"></i>'; }, 2000);
                });
            } else {
                const textArea = document.createElement("textarea");
                textArea.value = ipAddress;
                textArea.style.position = "fixed";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    this.textContent = 'ุชู ุงููุณุฎ! โ';
                    setTimeout(() => { this.innerHTML = 'Soon... <i class="fas fa-copy"></i>'; }, 2000);
                } catch (err) {
                    alert('ูุดู ุงููุณุฎ ูุฏููุงู: ' + ipAddress);
                }
                document.body.removeChild(textArea);
            }
        });
    });

    // =========================================================
    // 4. ุดุฑูุท ุชูุฏู ุงูุงูุถูุงู
    // =========================================================
    document.querySelectorAll('.join-steps-grid .step-card a, .join-steps-grid .step-card button').forEach((element, index) => {
        element.addEventListener('click', () => {
            const progress = (index + 1) / 3;
            const progressElement = document.getElementById('join-progress');
            if (progressElement) progressElement.style.width = `${progress * 100}%`;
        });
    });

    // =========================================================
    // 5. Chart.js ูุฅุญุตุงุฆูุงุช ุงููุงุนุจูู
    // =========================================================
    const ctx = document.getElementById('playerTrafficChart');
    if (ctx) {
        const gradient = ctx.getContext('2d').createLinearGradient(0, 0, 0, 400);
        gradient.addColorStop(0, 'rgba(0, 123, 255, 0.5)');
        gradient.addColorStop(1, 'rgba(15, 44, 73, 0.05)');

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['00:00','04:00','08:00','12:00','16:00','20:00','24:00'],
                datasets: [{
                    label: 'ุนุฏุฏ ุงููุงุนุจูู ุงูููู',
                    data: [89,80,72,56,64,90,96],
                    borderColor: 'var(--primary-color)',
                    borderWidth: 3,
                    backgroundColor: gradient,
                    pointBackgroundColor: 'var(--primary-color)',
                    pointBorderColor: 'var(--dark-bg)',
                    pointBorderWidth: 2,
                    tension: 0.4,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: '#333', drawBorder: false },
                        ticks: { color: 'var(--light-grey)' }
                    },
                    x: { grid: { display: false }, ticks: { color: 'var(--light-grey)' } }
                },
                plugins: { legend: { labels: { color: 'var(--text-color)' } } }
            }
        });
    }
    // =========================================================
// 6. Modal / Pop-up (ุงููุตุต ูุงููุงูุฐุฉ ุงูููุจุซูุฉ)
// =========================================================

// ๐ฅ ุชุนุฑูู ูุญุชูู ุฌููุน ุงููุตุต ูู ูุงุฆู ูุงุญุฏ (ุจูุญุชูู ุทููู ูููุตู)
const allStoryData = {
    // 1. ุงููุตุฉ ุงูุฃุตููุฉ 1: ุงููุทุงุฑุฏุฉ
    'chase': {
        title: 'ุฃุดุฑุณ ูุทุงุฑุฏุฉ 5 ูุฌูู!',
        excerpt: 'ูุตุฉ ุถุงุจุท ุดุฑุทุฉ ูุฑูู ุชูุงุตูู ูุทุงุฑุฏุฉ ูุฌูููุฉ ุงูุชุฏุช ูู ุงูุทุฑูู ุงูุณุฑูุน ุฅูู ุงูุฃุฒูุฉ ุงูุฎูููุฉ ูููุฏููุฉ.',
        content: `
            <h1>ุฃุดุฑุณ ูุทุงุฑุฏุฉ ูู ุงููุฏููุฉ: ุถุงุจุท ูุฑูู ูุง ุญุฏุซ ูู ุชูู ุงููููุฉ ุงููุฌูููุฉ</h1>
            
            <p>ุงูุณุงุนุฉ ูุงูุช <strong>03:00 ุจุนุฏ ููุชุตู ุงูููู</strong>. ุงููุฏููุฉ ุดุจู ูุงุฆูุฉุ ุงูุดูุงุฑุน ูุงุฑุบุฉุ ูุงููุฏูุก ูุบุทู ุงูููุงู ูุบุทุงุก ุซููู. ูุงู ุงูุถุงุจุท <strong>ูุงุณูู</strong>ุ ุตุงุญุจ ุงูุฎุจุฑุฉ ุงูุทูููุฉ ูุงููุฏูุก ุงููุนุฑููุ ูู ุฏูุฑูุฉ ุฑูุชูููุฉ ุจุงููุฑุจ ูู ููุทูุฉ ุงููููุงุก ุนูุฏูุง ุงูุชูุท ุฌูุงุฒ ุงูุงุชุตุงู ุจูุงุบูุง ููุทุน ุตูุช ุงูููู: ุณูุงุฑุฉ ุฑูุงุถูุฉ ุณูุฏุงุก ูุณุฑููุฉุ ูู ุทุฑุงุฒ "ููููุช"ุ ุชูุทูู ุจุณุฑุนุฉ ุฌููููุฉ ุชุฌุงูุฒุช 200 ูู/ุณุงุนุฉ ูู ุงูุทุฑูู ุงูุณุฑูุน ุงูุฌููุจู.</p>

            <p>ุจุนุฏ ุฎูุณ ุฏูุงุฆู ูู ุงูููุงุฏุฉ ุงููุตููุ ุธูุฑุช ุงูุณูุงุฑุฉ ุฃูุงู ูุงุณูู. ูุงูุช ุฃุถูุงุก ุงููุฑุงูู ุงูุฎูููุฉ ุชุจุฏู ููุฃููุง ูุฌูู ุญูุฑุงุก ูุดุชุนูุฉ ูู ุงูุธูุงูุ ูููุงูุฐูุง ูุธููุฉ ุจุงููุงููุ ูุตูุช ูุญุฑููุง ูุตุฑุฎ ููุญุด ุฌุฑูุญ. ูุจูุฌุฑุฏ ุฃู ูุงุญุธ ุงูุณุงุฆู ูุฌูุฏ ุณูุงุฑุฉ ุงูุดุฑุทุฉ ุฎูููุ ูุงู ุงูุฑุฏ ููุฑูุงู ููุชููุฑุงู: ุถุบุท ุนูู ุงูุจูุฒูู ุจูู ูุง ููููุ ูุญูููุงู ุงููุทุงุฑุฏุฉ ูู ุนูููุฉ ุงุณุชููุงู ุฅูู ุณุจุงู ุญูุงุฉ ุฃู ููุช.</p>
            
            <p><strong>ุงููุฑุญูุฉ ุงูุฃููู: ุงูุทุฑูู ุงูุณุฑูุน.</strong> ุงูุทููุช ุตูุงุฑุงุช ุณูุงุฑุฉ ุงูุดุฑุทุฉ. ุงุดุชุนูุช ุงูุฃุถูุงุก ุงูุฒุฑูุงุก ูุงูุญูุฑุงุก. ุฏุฎูุช ุงูุณูุงุฑุชุงู ูู ุฑูุตุฉ ุฌููููุฉ ุนูู ุงูุทุฑูู ุงูุณุฑูุน. ุงูุณุงุฆู ุงููุงุฑุจ ูุงู ูุญุชุฑูุงู ุฃู ูุฌูููุงูุ ูุชุฌุงูุฒ ุงูุดุงุญูุงุช ุงูุถุฎูุฉ ุนูู ุณุฑุนุงุช ุบูุฑ ููุทููุฉ. ุทูุจ ูุงุณูู ุงูุฏุนู ุนุจุฑ ุงูุฑุงุฏููุ ูููู ูุงู ูุฏุฑู ุฃู ุงูุฏุนู ูู ูุตู ูุฑูุจุงู. ุนูุฏ ูุฏุฎู ุงูุฌุณุฑ ุงููุนููุ ุงูุญุฑูุช ุงูุณูุงุฑุฉ ุงููุณุฑููุฉ ุจุญุฏุฉ ูุญู ููุญุฏุฑ ุฎุฑูุฌ ุถููุ ูุงุฏ ูุงุณูู ุฃู ูููุฏ ุงูุณูุทุฑุฉ ูููุง ุฎุจุฑุชู ุงูุชู ุฃููุฐุชู ูู ุงููุญุธุฉ ุงูุฃุฎูุฑุฉ. ุตุฑุฎ ูุงุณูู: "ุงููุดุจูู ุฎุทุฑุ ูุณูู ุงูุฃุฒูุฉ ุงูุขู! ุงุทูุจูุง ุงูุฏุนู ููุฑุงู ูุบูู ุงููุฎุฑุฌ ุงูุดูุงูู!"</p>
            
            <p><strong>ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุฏุงุฎู ุงููุฏููุฉ.</strong> ุชุญููุช ุงููุทุงุฑุฏุฉ ุฅูู ูุชุงูุฉ ุฏุงุฎู ุดุจูุฉ ุงูุฃุฒูุฉ ุงูุถููุฉ ูุงููุธููุฉ ูู ุงูููุทูุฉ ุงูุตูุงุนูุฉ ุงููุฏููุฉ. ูุณุฑ ุงูุณุงุฆู ุซูุงุซ ุฅุดุงุฑุงุช ุถูุฆูุฉุ ููุงุฏ ูุฑุชุทู ุจุชุฑุงููุงู ูุชููู. ุดุนุฑ ูุงุณูู ุจุงูุฅุญุจุงุท ููุญุธุฉุ ูููู ุชุฐูุฑ ุงููุงุนุฏุฉ: "ุงูููุงุญูุฉ ููุณุช ุนู ุงูุณุฑุนุฉุ ุจู ุนู ุงูุซุจุงุช." ุนูุฏูุง ูุตู ุฅูู ูุฏุฎู ุฃุญุฏ ุงูุฃุญูุงุก ุงูุณูููุฉุ ุงูุญุฑู ุงูุณุงุฆู ุจููุฉ ูุญู ุทุฑูู ุชุฑุงุจูุ ูุซูุฑุงู ุณุญุงุจุฉ ูุซููุฉ ูู ุงูุบุจุงุฑ ุงุฎุชูู ูููุง ุชูุงูุงู.</p>

            <p><strong>ุงูููุงูุฉ ุงูุฏุฑุงููุฉ:</strong> ูู ูููุฏ ูุงุณูู ุชุฑููุฒู. ุชููู ููุญุธุฉุ ูุงุญุธ ุฃุซุฑ ุฅุทุงุฑุงุช ุนูู ุงูุฃุฑุถุ ููุงู ุจุซูุฉ ุนุจุฑ ุงูุฑุงุฏูู: "ุฑุงุญ ููุฐุง ุงูุงุชุฌุงูุ ุงุชุจุนููู!". ุจุนุฏ ูุทุงุฑุฏุฉ ุฏุงูุช 45 ุฏูููุฉ ูุงููุฉุ ุงูุชูู ุงูุฃูุฑ ุจุตูุช ุชุตุงุฏู ููู ุนูุฏ ุฒุงููุฉ ูุฎุฒู ูุฏูู. ูุฌุฏูุง ุงูุณูุงุฑุฉ ูุญุทูุฉุ ูุงูุณุงุฆูุ ุฑุฌู ูู ุฃูุงุฆู ุงูุซูุงุซููุงุชุ ูุฑููุงู ูุญุงูู ุงููุฑุจ ุนูู ูุฏููู. ูุญูู ูุงุณููุ ูุฃูุณู ุจู ูุจู ุฃู ูุจุชุนุฏ ุฃูุซุฑ ูู ุฎูุณ ุฎุทูุงุช. ูุงูุช ูุญุธุฉ ุตูุช ุทูููุฉ ุจููููุง ูุจู ุฃู ุชุตู ุณูุงุฑุงุช ุงูุฏุนู.</p>

            <p>ุนูุฏูุง ุณุฃููู ูู ุงููุฑูุฒ ููู ุฃูุณู ุจู ุฑุบู ุงูุธูุงู ูุตุนูุจุฉ ุงูุทุฑููุ ุงุจุชุณู ูุงุณูู ููุงู ุจูุฏูุฆู ุงููุนููุฏ: <strong>"ูุง ูุงูุด ูุงุฑุจ ููู... ูุงู ูุงุฑุจ ูู ุฑูุญู. ูุงููู ููุฑุจ ูู ุฑูุญู ุฏููุง ูุฎูู ุฃุซุฑ."</strong></p>
        `
    },
    
    // 2. ุงููุตุฉ ุงูุฃุตููุฉ 2: ุชุฃุณูุณ ุงูุนุงุฆูุฉ
    'family': {
        title: 'ุชุฃุณูุณ ุงูุนุงุฆูุฉ: ุงูุฅูุจุฑุงุทูุฑูุฉ',
        excerpt: 'ููู ุชุญูู ุดุงุจ ูุชูู ูุฏุนู ุณุงูู ุฅูู ูุงุฆุฏ ูุฅูุจุฑุงุทูุฑูุฉ ุชูุญุณุจ ููุง ุฃูู ุญุณุงุจุ ูุดุฃุช ูู ุฑุญู ุงูุดุฏุฉ ูููุณ ุงูุฏู.',
        content: `
            <h1>ูุตุฉ ุชุฃุณูุณ ุงูุนุงุฆูุฉ: ูู ุดุงุจ ูุญูุฏ ุฅูู ุฅูุจุฑุงุทูุฑูุฉ ุชูุญุณุจ ููุง ุฃูู ุญุณุงุจ</h1>
            
            <p>ูู ุญู ุตุบูุฑ ุนูู ุฃุทุฑุงู ุงููุฏููุฉุ ุญูุซ ูุงูุช ุงูุญูุงุฉ ุตุนุจุฉ ูุงููุงููู ุบุงุฆุจุงูุ ุนุงุด ุดุงุจ ููุฏุนู <strong>ุณุงูู</strong>. ูุชูู ุงููุงูุฏููุ ูููู ูุงู ูุญูู ูู ุฏุงุฎูู ุดูุฆูุง ูู ููุงุญุธู ุฃุญุฏ: ุฅุตุฑุงุฑ ุนูู ุฃู ูุตูุน ูููุณู ุงุณููุง ูุง ูููุณู. ูุงู ูุนูู ูู ูุฑุดุฉ ูุฅุตูุงุญ ุงูุณูุงุฑุงุช ุฎูุงู ุงูููุงุฑุ ููุถู ููุชู ุจูู ุฒููุช ุงููุญุฑูุงุช ูุตูุช ุงูุขูุงุชุ ููู ุงูููู ูุฌูุณ ุนูู ุณุทุญ ููุฒูู ุงููุชูุงุถุน ูุฎุทุท ููุณุชูุจู ุฃูุจุฑ ูู ุงูููุงู ุงูุฐู ูุนูุด ููู. ูู ููู ุณุงูู ูููุงู ุฌุณุฏูุงูุ ูููู ูุงู ูููู ุฐูุงุกู ุญุงุฏุงู ููุธุฑุฉ ุซุงูุจุฉ ูููุณุชูุจู.</p>

            <p>ูู ุนูุฑ ุงูุนุดุฑููุ ุชุนุฑูู ุณุงูู ุนูู ูุฌููุนุฉ ุดุจุงุจ ูู ุงูุญูุ ูู ูุงุญุฏ ูููู ูุงู ููุฑ ุจุธุฑูู ูุงุณูุฉ: <strong>ุฎุงูุฏ</strong> (ุงูููุฉ ุงูุฌุณุฏูุฉ)ุ ูุทุฑูุฏ ูู ุงูุฌูุด ููุจุญุซ ุนู ุงูุงูุชูุงุกุ ู<strong>ูุงุฑุณ</strong> (ุงูุนูู ุงููุฏุจุฑ)ุ ุฎุฑูุฌ ุฌุงูุนู ูู ูุฌุฏ ุนููุงู ููููู ูุงู ุฎุจูุฑุงู ูู ุงูุญุณุงุจุงุช ูุงูุชุฎุทูุท. ูุงููุง ูุฎุชููููุ ููู ุณุงูู ุฑุฃู ูู ูู ูุงุญุฏ ูููู ูุทุนุฉ ููููุฏุฉ ูููู ุฃู ุชูุณุชุซูุฑ ูุชูููู ููุงู ูุชูุงูู.</p>
            
            <p>ุจุฏุฃุช ุงูููุฑุฉ ุจุณูุทุฉ: ูุฑูู ูุณุงุนุฏ ุจุนุถูุ ูุญูู ุจุนุถูุ ููุจุญุซ ุนู ูุฑุต ูุธููุฉ ููุฑุจุญ. ููุน ุงูููุชุ ุชุญููู ุงููุฑูู ุฅูู <strong>ุนุงุฆูุฉ</strong>... ููุณุช ุนุงุฆูุฉ ุฏูุ ุจู ุนุงุฆูุฉ ูููุฏุช ูู ุงูุดุฏุฉ. ูุฑูุฑ ุณุงูู ุฃู ูุฌุนู ุงูุนุงุฆูุฉ ุฃูุซุฑ ุชูุธูููุง. ูุถุน ููุงููู ุตุงุฑูุฉ: ูุง ุฎูุงูุฉุ ูุง ุธููุ ูุง ุงุณุชุฎุฏุงู ููููุฉ ุฅูุง ููุฏูุงุน ุนู ุงูุฃุนุถุงุก ูุงูุฃุจุฑูุงุกุ ูุงูุฃูู: ุงูุดุฑู ููู ูู ุดูุก. ุดูุฆูุง ูุดูุฆูุงุ ุจุฏุฃุช ุณูุนุชูู ุชูุจุฑ ูู ุงููุฏููุฉ. ุตุงุฑ ุงุณููู ูุฑุชุจุท ุจุงูุงุญุชุฑุงูุ ุจุงูููุจุฉุ ูุจุงููุฏุฑุฉ ุนูู ุญู ุงููุดุงูู ุงูุชู ูุง ูุณุชุทูุน ุงููุงููู ุญููุง.</p>

            <p><strong>ููุทุฉ ุงูุชุญูู:</strong> ูู ุฅุญุฏู ุงูููุงูู ุงูุจุงุฑุฏุฉุ ูุจูููุง ูุงููุง ูุฌุชูุนูู ูู ุงููุฎุฒู ุงููุฏูู ุงูุฐู ุงุชุฎุฐูู ููุฑูุง ูููุ ูุงู ุณุงูู ุจูููุง ูุงู ููุธุฑ ุฅูู ุงูุฎุฑูุทุฉ ุงููุนููุฉ ุนูู ุงูุฌุฏุงุฑ: <strong>"ุฅุญูุง ูุง ุฌููุงุด ุจุงุด ูููููุง ุนุตุงุจุฉ ุตุบูุฑุฉ.. ุฅุญูุง ุฌุงููู ูุจููู ุฅูุจุฑุงุทูุฑูุฉ ุญููููุฉุ ููุงู ูุญูููุง ููุญูู ููุทูุชูุง."</strong> ูุงูุช ูุฐู ุงูุฌููุฉ ุจุฏุงูุฉ ูุตู ุฌุฏูุฏ.</p>

            <p>ุชูุณุน ูุดุงุทูู: ุชุญููุช ูุฑุดุฉ ุงูุชุตููุญ ุฅูู ูุฑูุฒ ูุฅุฏุงุฑุฉ ุงูุฃุนูุงูุ ุฃุณุณูุง ุดุฑูุฉ ููู ุตุบูุฑุฉุ ุซู ุจุฏุฃูุง ูู ุชูุฏูู ุฎุฏูุงุช "ุงูุญูุงูุฉ" ูุจุนุถ ุงูุชุฌุงุฑ ุงูุตุบุงุฑ ูู ุงูุญู. ุชูุณุน ูููุฐูู ููุดูู ูุธุงูุงู ูุงููุงู ูุฏูุฑู ุฑุฌุงู ูุนุฑููู ูููุชู. ุจุนุฏ ุณูุชูู ููุทุ ูู ูุนุฏ ุฃุญุฏ ูุณูุน ุจุงุณู ุณุงูู ูุนุงูู ุจุณูุท... ุจู ููุงุฆุฏ ูุนุงุฆูุฉ ุชูุญุชุฑู ูุชูุญุณุจ ููุง ุฃูู ุญุณุงุจุ ุนุงุฆูุฉ ุชุญูู ุดุนุงุฑุงู ูุงุญุฏุงู: <strong>ุงูููุฉ ูู ุงูุงุชุญุงุฏุ ูุงูุฅุฎูุงุต ูู ุงูุถูุงู.</strong></p>
        `
    },
    
    // 3. ุงููุตุฉ ุงูุฌุฏูุฏุฉ 3: ุงููููุงูููู ุงููุธููู
    'mechanic': {
        title: 'ุณุฑ ุตููุฉ ุงูููู ุงูุฃุฎูุฑุฉ',
        excerpt: 'ูููุงูููู ูุงูุฑ ููุฑุฑ ูู ุงุฑุชุจุงุทู ุจุนุตุงุจุฉ "ุงูุญูุช" ุจุฎุทุฉ ุฐููุฉ ููุญูููุฉ ุจุงููุฎุงุทุฑ.',
        content: `
            <h1>ุงููููุงูููู ุงููุธููู: ุณุฑ ุตููุฉ ุงูููู ุงูุฃุฎูุฑุฉ</h1>
            <p>ูุงูุช ุฑุงุฆุญุฉ ุงูุฒูุช ุงููุญุชุฑู ูุงูุตุฏุฃ ูู ุฑุงุฆุญุฉ ููุฒู "ุณุงูู" ุงูุซุงููุ ูุฑุดุฉ ุงูุฅุตูุงุญ ุงููุฏููุฉ. ุณุงูู ูุงู ุงูุฃูุถู ูู ุงููุฏููุฉุ ููู ูุฐุง ูู ูููุนู ูู ุงููููุน ูู ุดุฑู ุนุตุงุจุฉ "ุงูุญูุช"ุ ุงูุชู ุฃุฌุจุฑุชู ุนูู ุฅุตูุงุญ ูุชุฌููุฒ ุณูุงุฑุงุชูุง ุงููุณุฑููุฉ ูุงูููุบููุฉ. ูุงูุช ุญูุงุชู ุฃุดุจู ุจุงูุนุจูุฏูุฉุ ูุนูู ุชุญุช ุงูุชูุฏูุฏ ุงููุณุชูุฑ. ูู ุฅุญุฏู ุงูุฃูุณูุงุชุ ุงุณุชูู ุณุงูู ุณูุงุฑุฉ ุฏูุน ุฑุจุงุนู ูุงุฎุฑุฉุ ููุฏ ุนูู ุฃููุง ุณุชูุณุชุฎุฏู ูู ุนูููุฉ ูุจุฑู. ููุง ูุฑุฑ ุฃู ูุถุน ุฎุทุชู ุงูุฃุฎูุฑุฉ.</p>
            
            <p><strong>ุงูุฎุทุฉ ุงูุณุฑูุฉ:</strong> ุจุฏู ุฃู ููุชูู ุงูุฅุตูุงุญุ ูุงู ุณุงูู ุจุฒุฑุน ุฌูุงุฒ ุชุนูุจ ุณุฑู ุตุบูุฑ (ูุงู ูุฏ ุงุดุชุฑุงู ููุฐ ุฃุดูุฑ ุชุญุณุจุงู ููุฐุง ุงูููู) ูู ุงููููู ุงูุณููู ููุณูุงุฑุฉุ ูุชุฃูุฏ ูู ุฑุจุทู ุจูุธุงู ููุฑุจุงุฆู ูุนุฒูู. ูู ููู ูุณุชุทูุน ุงูุฐูุงุจ ููุดุฑุทุฉ ูุจุงุดุฑุฉุ ูููู ุชุฐูุฑ ูุฌูุฏ ุถุงุจุท ูุฒูู (ูุงุณูู ูู ูุตุฉ ุงููุทุงุฑุฏุฉ) ูุงู ูุฑุงูุจ ูุดุงุท ุงูุนุตุงุจุงุช. ุฃุฑุณู ุฑุณุงูุฉ ูุดูุฑุฉ ูุตูุฑุฉ ุจู"ููุฏ" ูุฏูู ูุนุฑูู ุงูุถุงุจุทุ ูุฎุจุฑู ูููุง ุนู "ูุฏูุฉ" ุณุชุตู ุฅูู ุงููุฎุฒู ุงููุฏูู ูู ุชูุงู ุงูุฑุงุจุนุฉ ูุฌุฑุงู.</p>
            
            <p>ูู ุชูู ุงููููุฉุ ุณูู ุณุงูู ุงูุณูุงุฑุฉ ููุญูุชุ ููุงู ููุจู ููุจุถ ุจููุฉ ุชูุงุฏ ุชูุณูุน. ุจุนุฏ ุณุงุนุชููุ ูุงู ุณุงูู ูุณุชูุน ุฅูู ุงูุฑุงุฏูู ุงููุงุฏุฆ ูู ูุฑุดุชู ุนูุฏูุง ุณูุน ุตูุงุฑุงุช ุงูุดุฑุทุฉ ุงูุจุนูุฏุฉ ุชุชุฌู ูุญู ุงููุฎุฒู. ูุงู ุงูุฃูุฑ ูุฎุงุทุฑุฉ ุฌููููุฉุ ููููุง ูุฌุญุช. ูุฌุญ ุณุงูู ูู ูุณุจ ุญุฑูุชู ูุชูุฏูู ุฃูุจุฑ ูุณุงุนุฏุฉ ููุดุฑุทุฉ ุฏูู ุฃู ูุนุฑุถ ููุณู ููุฎุทุฑ ุงููุจุงุดุฑ. ูู ูุนุฏ ูุฌุฑุฏ ูููุงููููุ ุจู ุฃุตุจุญ ุจุทูุงู ุบูุฑ ูุนูู ูู ุงููุฏููุฉ.</p>
        `
    },
    
    // 4. ุงููุตุฉ ุงูุฌุฏูุฏุฉ 4: ุงูุตุญููุฉ
    'journalist': {
        title: 'ุงูุตุญููุฉ ูุงููุบูู ุงูุฃุญูุฑ',
        excerpt: 'ุชุญููู ุงุณุชูุตุงุฆู ูุตุญููุฉ ุดุงุจุฉ ููุฏุฏ ุจูุดู ุดุจูุฉ ูุณุงุฏ ูุจุฑู ูู ุงููุฏููุฉุ ููุซูุฑ ูุทุงุฑุฏุฉ ูู ููุน ุขุฎุฑ.',
        content: `
            <h1>ุงูุตุญููุฉ ูุงููุบูู ุงูุฃุญูุฑ: ูุดู ุดุจูุฉ ุงููุณุงุฏ</h1>
            <p>'ูููู' ุตุญููุฉ ุดุงุจุฉ ูุชุฎุตุตุฉ ูู ุงูุชุญูููุงุช ุงูุงุณุชูุตุงุฆูุฉ. ูู ุชูู ุชูุชู ุจุงููุตุต ุงูุณุทุญูุฉ. ูุงู ูุฏููุง ุฏุงุฆูุงู ูู ุงูุญูููุฉ. ูู ููู ููุทุฑุ ุชููุช ูุบููุงู ุฃุญูุฑ ุบุงูุถุงู ูู ุตูุฏูู ุจุฑูุฏูุง. ูู ููู ูุญูู ุฑุณุงูุฉุ ุจู ูุฌููุนุฉ ูู ุงูุตูุฑ ุนุงููุฉ ุงูุฏูุฉ ูุฅุซุจุงุชุงุช ูุตุฑููุฉ ุชุฏูู ุดุฎุตูุงุช ูุงูุฐุฉ ูู ูุฌูุณ ุงููุฏููุฉ ูุงูุดุฑุทุฉุ ูุชูุฑุทูู ูู ุนูููุงุช ุบุณูู ุฃููุงู ูุชูุฑูุจ.</p>
            
            <p><strong>ุงููุทุงุฑุฏุฉ ุชุจุฏุฃ:</strong> ุฃุฏุฑูุช ูููู ุฃู ูุดุฑ ูุฐู ุงููุตุฉ ุณููุฏุฏ ุญูุงุชูุงุ ููููุง ูุฑุฑุช ุงููุถู ูุฏูุงู. ุจุฏุฃุช ุงูุนูู ูู ุงูุธูุ ุชุชููู ุจูู ุงูููุงูู ุงูููุฌูุฑุฉ ููุฎุงุฒู ุงููุซุงุฆู ุงููุฏููุฉ ูุชุฑููุจ ูุทุน ุงููุบุฒ. ูุงู ุนูููุง ุฃู ุชุฎุชูู ุนู ุงูุฃูุธุงุฑุ ูุฃููุง ูุงุญุธุช ุณูุงุฑุฉ ุณูุฏุงุก ุชุชุจุนูุง ููุฐ ููููู. ูุงู ุงูุฃูุฑ ููุณ ูุฌุฑุฏ ุชุญูููุ ุจู ุณุจุงู ููุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ.</p>

            <p>ูุฌุญุช ูููู ูู ุงุณุชุฎุฏุงู ูุตุงุฏุฑ ุณุฑูุฉ ุฏุงุฎู ุงููุธุงูุ ูุญุตูุช ุนูู ูุซููุฉ ุฃุฎูุฑุฉ ุชุคูุฏ ุชูุฑุท ุฑุฆูุณ ุงูุจูุฏูุฉ ูู ุงููุถูุฉ. ููู ุนูููุฉ ุฏุฑุงููุฉุ ูุงูุช ุจูุดุฑ ูู ุงููุซุงุฆู ุนุจุฑ ุดุจูุฉ ุงูุฅูุชุฑูุช ูู ููุณ ุงููุญุธุฉ ุงูุชู ูุงูุช ุชุญุงูู ูููุง ุงููุฑุงุฑ ูู ุงููุฏููุฉ. ุชุณุจุจุช ุงููุตุฉ ูู ุฒูุฒุงู ูุฒ ุฃุฑูุงู ุงูุญูููุฉ ุงููุญููุฉ. ูููู ูู ุชูุฌุญ ูู ุงููุฑุงุฑ ุจุฌุณุฏูุง ููุทุ ุจู ูุฌุญุช ูู ุชุฏููุฑ ุดุจูุฉ ูุณุงุฏ ูุงููุฉุ ูุชุซุจุช ุฃู ุงูููู ุฃููู ุจูุซูุฑ ูู ุงูุฑุตุงุต.</p>
        `
    },
    
    // 5. ุงููุตุฉ ุงูุฌุฏูุฏุฉ 5: ุงูุณุฑูุฉ
    'heist': {
        title: 'ุณุงุนุฉ ุงูุตูุฑ: ุณุฑูุฉ ุงููุชุญู ุงููุจูุฑ',
        excerpt: 'ุงูุชูุงุตูู ุงูุฏูููุฉ ูุฃูุจุฑ ุนูููุฉ ุณุฑูุฉ ุชูุช ุจุชุฎุทูุท ุฏููู ูุฌููุฑุฉ "ุงูุดุฑู"ุ ูุงููุฑูู ุงูุฐู ููุฐูุง.',
        content: `
            <h1>ุณุงุนุฉ ุงูุตูุฑ: ุณุฑูุฉ ุงููุชุญู ุงููุจูุฑ</h1>
            <p>ูุงู ุงููุฏู ูู ุฌููุฑุฉ "ุงูุดุฑู"ุ ูุงุณุฉ ูุงุฏุฑุฉ ูุง ุชูุฏุฑ ุจุซููุ ูุญููุธุฉ ุฏุงุฎู ุงููุชุญู ุงููุฑูุฒู ูู ุงููุฏููุฉ. ุงูุฎุทุฉ ุงุณุชุบุฑูุช ุณุชุฉ ุฃุดูุฑ ูู ุงูุชุฎุทูุท ูุงููุฑุงูุจุฉ. ุงููุฑููุ ุจููุงุฏุฉ "ุงููุงูุณุชุฑู"ุ ูุงู ููููุงู ูู ุซูุงุซุฉ ุฃุดุฎุงุต: <strong>ุนุงุฒู ุงูุจูุงูู</strong> (ุฎุจูุฑ ุงูุชูููุฉ ูุงูุฃูู)ุ <strong>ุงูุธู</strong> (ุงููุชุฎุตุต ูู ุชุฌุงูุฒ ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ)ุ ู<strong>ุงูุญูุงุฑ</strong> (ููุฉ ุงูุชูููุฐ ูุงูููุงุฏุฉ ุฃุซูุงุก ุงูุนูููุฉ). ูุงู ููู ูููู ุฏูุฑ ูุง ูุญุชูู ุงูุฎุทุฃ.</p>
            
            <p>ูู ูููุฉ ุงูุชูููุฐุ ุชุณูู ุนุงุฒู ุงูุจูุงูู ุฅูู ุบุฑูุฉ ุงูุชุญูู ุงูุซุงูููุฉ ูุฃููู ูุงููุฑุงุช ุงููุฑุงูุจุฉ ููุฏุฉ 180 ุซุงููุฉ ุจุงูุถุจุท. ูู ูุฐู ุงูุซูุงููุ ูุงู ุงูุธู ูุงูุญูุงุฑ ูุฏ ุชุฌุงูุฒุง ุงูุฌุฏุงุฑ ุงูุฎููู ูุฏุฎูุง ุงููุชุญู. ูุงูุช ุงููุฑุญูุฉ ุงูุฃุตุนุจ ูู ุบุฑูุฉ ุงูุนุฑุถุ ุญูุซ ูุงูุช ุงูุฌููุฑุฉ ูุญููุฉ ุจุดุจูุฉ ููุฒุฑ ูุนูุฏุฉ. ุชุญุฑู ุงูุธู ุจุฎูุฉ ูุง ุชุตุฏูุ ูุชุฌูุจ ูู ุดุนุงุน ููุฒุฑุ ุจูููุง ูุงู ุงูุญูุงุฑ ูุฌูุฒ ุฌูุงุฒ ุชุจุฑูุฏ ูุชุทูุฑ ููุณุฑ ุงูุฒุฌุงุฌ ุงููุตูุญ ุงููุญูุท ุจุงูุฌููุฑุฉ.</p>
            
            <p>ุจุนุฏ ุซูุงุซ ุฏูุงุฆู ูุฎูุณูู ุซุงููุฉุ ุฎุฑุฌ ุงููุฑูู ุจุงูุฌููุฑุฉุ ุชุงุฑููู ุฎูููู ุฎุฒุงูุฉ ููุชูุญุฉ ูุฑุณุงูุฉ ูุตูุฑุฉ ุชููู: "ูุงู ุงูุฃูุฑ ูููุงู". ูุฌุญุช ุงูุณุฑูุฉุ ููู ุงูุฎุทุฑ ูู ููุชูู. ุงูุขูุ ูุฌุจ ุนูู ุงููุงูุณุชุฑู ุฃู ูุฌุฏ ุทุฑููุฉ ูุชุณููู ุงูุฌููุฑุฉ ุฏูู ุฃู ูุชู ุงูุฅูุณุงู ุจู ูู ูุจู ุฃูุจุฑ ููุงูุงุช ุงูุฃูู ูู ุงูุนุงูู. ุงููุตุฉ ูู ุชูุชูู ุจุนุฏ...</p>
        `
    },
    
    // 6. ุงููุตุฉ ุงูุฌุฏูุฏุฉ 6: ุงูุนูุฏุฉ
    'mayor': {
        title: 'ุนูุฏุฉ ุงูุนูุฏุฉ ุงููุชูุงุนุฏ',
        excerpt: 'ุจุนุฏ ุณููุงุช ูู ุงูุบูุงุจุ ูุนูุฏ ุงูุนูุฏุฉ ุงูุณุงุจู ููุฎูุถ ุญุฑุจุงู ุณูุงุณูุฉ ุดุฑุณุฉ ูุฅููุงุฐ ุงููุฏููุฉ ูู ุงููุณุงุฏ.',
        content: `
            <h1>ุนูุฏุฉ ุงูุนูุฏุฉ ุงููุชูุงุนุฏ: ุงูุญุฑุจ ุงูุฃุฎูุฑุฉ</h1>
            <p>ุงูุนูุฏุฉ "ุนุงุฏู" ูุงู ููุนุชุจุฑ ุฃุณุทูุฑุฉ ุงููุฒุงูุฉ ูุงูุฅูุฌุงุฒ. ุจุนุฏ ุชูุงุนุฏู ุงููุจูุฑุ ุนุงุด ูู ูุฏูุก ุจุนูุฏุงู ุนู ุฃุถูุงุก ุงูุณูุงุณุฉ. ููู ุนูุฏูุง ุฑุฃู ูุฏููุชู ุชุบุฑู ูู ุงูููุถู ูุงููุณุงุฏ ุชุญุช ููุงุฏุฉ ุฎููู "ููุงุฒ"ุ ุงูุฐู ูุงู ูุณูู ุนูู ุงูุนุตุงุจุงุช ููุงุจู ุงููุงูุ ูุฑุฑ ุงูุนูุฏุฉ. ูู ุชูู ุนูุฏุฉ ุณููุฉุ ููุฏ ูุงุฌู ุญููุฉ ุชุดููู ุดุฑุณุฉ ูุถุบูุทุงู ูุงุฆูุฉ. ูุงู ุนููู ุฃู ูุจุฏุฃ ูู ุงูุตูุฑุ ููุงูุญ ุดุจูุฉ ูุตุงูุญ ูุชุฑุงุจุทุฉ.</p>
            
            <p>ุงุณุชุบู ุนุงุฏู ุงุชุตุงูุงุชู ุงููุฏููุฉุ ูุจุฏุฃ ุจุฌูุน ุงูุฃุฏูุฉ. ูุฌุฏ ููุณู ูู ุตุฑุงุน ููุณ ุถุฏ ุดุฎุต ูุงุญุฏุ ุจู ุถุฏ ูุธุงู ูุงูู. ุงููุตุฉ ุชุฑูุฒ ุนูู ุงูุชุญุฏูุงุช ุงูุณูุงุณูุฉ ูุงููุนุถูุงุช ุงูุฃุฎูุงููุฉ: ูู ูุณุชุฎุฏู ุฃุณุงููุจ ุบูุฑ ูุธููุฉ ูููุงุฌูุฉ ุงูุฎุตูู ุบูุฑ ุงููุฒููููุ ูุฑุฑ ุนุงุฏู ุฃู ูุจูู ูููุงู ููุจุงุฏุฆู. ูุงูุช ุญููุชู ุชุฑุชูุฒ ุนูู ุงูุดูุงููุฉ ููุดู ุงูุญูุงุฆู ููุฌูููุฑ. ูู ููู ุงูุงูุชุฎุงุจุงุชุ ูุงู ุงููุงุฑู ุถุฆููุงูุ ููู ุซูุฉ ุงููุงุณ ููู ูุงูุช ุฃูุจุฑ ูู ููุฉ ุงููุงู. ูุฌุญ ุนุงุฏู ูู ุฅุฒุงุญุฉ ููุงุฒุ ููููู ุฃุฏุฑู ุฃู ุงูุญุฑุจ ุงูุญููููุฉ ูุฅููุงุฐ ุงููุฏููุฉ ุจุฏุฃุช ููุชู.</p>
        `
    },
    
    // 7. ุงููุตุฉ ุงูุฌุฏูุฏุฉ 7: ุงูุทุจูุจ
    'doctor': {
        title: 'ุงูุฌุฑุงุญุฉ ุงููุณุชุญููุฉ',
        excerpt: 'ูุตุฉ ุฏูุชูุฑ "ูุฑุงุณ" ุงูุฐู ูุงู ุจุนูููุฉ ุฌุฑุงุญูุฉ ูุณุชุญููุฉ ูุฅููุงุฐ ุญูุงุฉ ุฒุนูู ุนุตุงุจุฉ ูุตุงุจ ุฅุตุงุจุฉ ุฎุทูุฑุฉ ุชุญุช ุชูุฏูุฏ ุงูุณูุงุญ.',
        content: `
            <h1>ุงูุฌุฑุงุญุฉ ุงููุณุชุญููุฉ: ุญูุงุฉ ุนูู ุงููุญู</h1>
            <p>ุงูุฏูุชูุฑ ูุฑุงุณุ ุฌุฑุงุญ ุงูููุจ ุงูุดููุฑุ ูุงู ูุนูุด ุญูุงุฉ ูุงุฏุฆุฉ ุญุชู ูููุฉ ุงูุชุญู ูููุง ุซูุงุซุฉ ุฑุฌุงู ููุซููู ููุฒูู. ุทูุจูุง ููู ุงูุฐูุงุจ ููุฑุงู ูุฅููุงุฐ ุญูุงุฉ "ุงูุฒุนูู"ุ ุฒุนูู ุฃูุจุฑ ุนุตุงุจุงุช ุงููุฏููุฉุ ุงูุฐู ุฃุตูุจ ุจุทูู ูุงุฑู ูู ููุงู ุญุณุงุณ. ูุงูุช ุญูุงุชู ูุญูุงุฉ ุนุงุฆูุชู ุนูู ุงููุญู. ูู ููู ูุฑุงุณ ุทุจูุจุงู ุนุงุฏูุงูุ ูููู ูู ููู ุฌุฑุงุญุงู ููุญุฑุจ.</p>
            
            <p><strong>ุบุฑูุฉ ุงูุนูููุงุช ุงูุจุฏููุฉ:</strong> ุชู ุงูุชูุงุฏ ูุฑุงุณ ุฅูู ูุณุชูุฏุน ููุฌูุฑ ุชุญูู ุฅูู ุบุฑูุฉ ุนูููุงุช ุจุฏุงุฆูุฉ. ุงูุฅุถุงุกุฉ ุถุนููุฉุ ุงูุฃุฏูุงุช ููุณุช ูุงููุฉุ ูุงูุญุฑุงุณ ููููู ุญููู ุจุฃุณูุญุชูู. ูุงู ุนููู ุฅุฌุฑุงุก ุฌุฑุงุญุฉ ูุนูุฏุฉ ูุฅุฎุฑุงุฌ ุงูุฑุตุงุตุฉ. ูู ูููุฑ ูู ูููุฉ ุงููุฑูุถุ ุจู ููุฑ ููุท ูู ูุณูู ูุทุจูุจ. ูุงูุช ูุฏุงู ุชุฑุชุฌูุงู ูู ุงูุจุฏุงูุฉุ ูููู ุงุณุชุนุงุฏ ุฑุจุงุทุฉ ุฌุฃุดู ูุฑูุฒ ุนูู ุฅููุงุฐ ุงูุญูุงุฉ ุฃูุงูู.</p>
            
            <p>ุงุณุชูุฑุช ุงูุนูููุฉ ูุซูุงุซ ุณุงุนุงุช ูู ุงูุชูุชุฑ ุงูุดุฏูุฏ. ูุฌุญ ูุฑุงุณ. ุงูุฒุนูู ูุฌุง. ุบุงุฏุฑ ูุฑุงุณ ุงููุณุชูุฏุน ูุน ุฃูู ุถูุก ููุตุจุงุญุ ูุน ุฅุฏุฑุงู ุฃู ุญูุงุชู ูู ุชุนุฏ ููุง ูุงูุช. ูุฌุงุฆุฒุฉุ ุญุตู ุนูู ุณูุงุฑุฉ ูุงุฎุฑุฉ ููุนุฏ ุจุฃูุง ูุชู ุฅุฒุนุงุฌู ูุฑุฉ ุฃุฎุฑู. ููู ูู ูููู ูุฌุฑูุงุญ ุฃู ููุณู ุงููููุฉ ุงูุชู ุฃููุฐ ูููุง ุญูุงุฉ ุงูุฑุฌู ุงูุฐู ุชููู ุงูุฌููุน ููุชูุ</p>
        `
    }
};

// ------------------------------------------------------------------
// ุชุนุฑูู ุงูุนูุงุตุฑ ุงูุฌุฏูุฏุฉ
// ------------------------------------------------------------------
// ูุงูุฐุฉ ุงููุตุฉ ุงูุฃุตููุฉ
const storyModal = document.getElementById('storyModal');
const closeStoryBtn = document.querySelector('#storyModal .close-btn');
const storyBody = document.getElementById('modal-story-body');

// ูุงูุฐุฉ ูุงุฆูุฉ ุงููุตุต ุงูุฌุฏูุฏุฉ
const allStoriesModal = document.getElementById('allStoriesModal');
const openAllStoriesBtn = document.getElementById('openAllStoriesModalBtn');
const closeAllStoriesBtn = document.querySelector('.close-btn-all-stories');
const allStoriesList = document.getElementById('all-stories-list');

// ------------------------------------------------------------------
// A. ููุทู ูุชุญ ูุฅุบูุงู ูุงูุฐุฉ ุงููุตุฉ ุงูุฃุตููุฉ (Story Modal)
// ------------------------------------------------------------------
const openModalButtons = document.querySelectorAll('.open-modal');

// ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ููุชุญ ูุงูุฐุฉ ุงููุตุฉ ูุนุฑุถ ุงููุญุชูู
function displayStory(storyKey) {
    const story = allStoryData[storyKey];
    if (story) {
        storyBody.innerHTML = story.content;
    } else {
        storyBody.innerHTML = '<h1>ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุตุฉ ุงููุทููุจุฉ.</h1>';
    }
    
    // ุฅุบูุงู ูุงูุฐุฉ ูุงุฆูุฉ ุงููุตุต ูุจู ูุชุญ ุงููุตุฉ ุงูุฃุตููุฉ
    if (allStoriesModal && allStoriesModal.classList.contains('show')) {
        allStoriesModal.classList.remove('show');
    }
    
    storyModal.classList.add('show');
    document.body.style.overflow = 'hidden';
}

// ุฑุจุท ุฃุญุฏุงุซ ุงูููุฑ ุจุฃุฒุฑุงุฑ "ุงูุฑุฃ ุงููุฒูุฏ" (ุงูุชู ุชูุชุญ ุงููุตุฉ ูุจุงุดุฑุฉ)
openModalButtons.forEach(button => {
    button.addEventListener('click', function() {
        const storyType = this.getAttribute('data-story');
        displayStory(storyType);
    });
});

// ุฑุจุท ุญุฏุซ ุงูุฅุบูุงู ูู ูุงูุฐุฉ ุงููุตุฉ ุงูุฃุตููุฉ
if (closeStoryBtn) {
    closeStoryBtn.addEventListener('click', () => {
        storyModal.classList.remove('show');
        setTimeout(() => { document.body.style.overflow = 'auto'; }, 400);
    });
}


// ------------------------------------------------------------------
// B. ููุทู ูุชุญ ูุฅุบูุงู ูุงูุฐุฉ ูุงุฆูุฉ ุงููุตุต ุงูุฌุฏูุฏุฉ (All Stories Modal)
// ------------------------------------------------------------------

// 1. ูุธููุฉ ููุก ุงููุงุฆูุฉ ุจุงููุตุต ุงูุฌุฏูุฏุฉ
function populateAllStoriesList() {
    if (!allStoriesList) return; 
    allStoriesList.innerHTML = ''; // ุชูุฑูุบ ุงููุงุฆูุฉ ุฃููุงู
    
    // ุฅูุดุงุก ุงูุจุทุงูุงุช ููู ูุตุฉ
    for (const key in allStoryData) {
        if (allStoryData.hasOwnProperty(key)) {
            const story = allStoryData[key];
            
            // ุฅูุดุงุก ุงูุจุทุงูุฉ ุงูุฌุฏูุฏุฉ (ุจุงุณุชุฎุฏุงู ููุณ data-story)
            const cardHTML = `
                <div class="story-list-card open-modal-from-list" data-story="${key}">
                    <h5>${story.title}</h5>
                    <p>${story.excerpt}</p>
                </div>
            `;
            allStoriesList.insertAdjacentHTML('beforeend', cardHTML);
        }
    }
    
    // 2. ุฑุจุท ุญุฏุซ ุงูููุฑ ููุชุญ ุงููุตุฉ ุงูุฃุตููุฉ ูู ุงููุงุฆูุฉ
    document.querySelectorAll('.open-modal-from-list').forEach(card => {
        card.addEventListener('click', function() {
            const storyType = this.getAttribute('data-story');
            displayStory(storyType); // ูุชุญ ูุงูุฐุฉ ุงููุตุฉ ุงูุฃุตููุฉ
        });
    });
}

// 3. ุฑุจุท ุญุฏุซ ุงููุชุญ ููุฒุฑ "ุนุฑุถ ุงููุฒูุฏ ูู ุงููุตุต"
if (openAllStoriesBtn) {
    openAllStoriesBtn.addEventListener('click', () => {
        populateAllStoriesList(); // ููุก ุงููุงุฆูุฉ ูุจู ุงููุชุญ
        allStoriesModal.classList.add('show');
        document.body.style.overflow = 'hidden';
    });
}

// 4. ุฑุจุท ุญุฏุซ ุงูุฅุบูุงู ูู ูุงูุฐุฉ ูุงุฆูุฉ ุงููุตุต ุงูุฌุฏูุฏุฉ
if (closeAllStoriesBtn) {
    closeAllStoriesBtn.addEventListener('click', () => {
        allStoriesModal.classList.remove('show');
        setTimeout(() => { document.body.style.overflow = 'auto'; }, 400);
    });
}

// ------------------------------------------------------------------
// C. ุงูุฅุบูุงู ุงูุนุงู ุนูุฏ ุงูููุฑ ุฎุงุฑุฌ ุฃู ูุงูุฐุฉ
// ------------------------------------------------------------------
window.onclick = (event) => {
    if (event.target == storyModal) {
        storyModal.classList.remove('show');
        setTimeout(() => { document.body.style.overflow = 'auto'; }, 400);
    } else if (event.target == allStoriesModal) {
        allStoriesModal.classList.remove('show');
        setTimeout(() => { document.body.style.overflow = 'auto'; }, 400);
    }
};

// ... (ุจููุฉ ุงูุฃูุณุงู ูู script.js)
    // =========================================================
    // 7. Count-Up Animation
    // =========================================================
    const statsSection = document.getElementById('stats');
    let hasAnimated = false;
    const stats = [
        { id: 'stat-registered', target: 5000, prefix: '+' },
        { id: 'stat-vehicles', target: 1000, prefix: '+' },
        { id: 'stat-days', target: 365, prefix: '' },
    ];
    function startCountUp() {
        if (hasAnimated) return;
        hasAnimated = true;
        stats.forEach(stat => {
            const element = document.getElementById(stat.id);
            if (!element) return;
            let current = 0;
            const increment = stat.target / 200;
            const timer = setInterval(() => {
                current += increment;
                if (current >= stat.target) { current = stat.target; clearInterval(timer); }
                element.textContent = stat.prefix + Math.round(current).toLocaleString('en-US');
            }, 10);
        });
    }
    if (statsSection) {
        new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) { startCountUp(); observer.unobserve(entry.target); }
            });
        }, { threshold: 0.5 }).observe(statsSection);
    }
// =========================================================
// 8. Chatbot AI (ููุญุฏููุซ ูุญู ูุดููุฉ ุงูุจุทุก ุจุงุณุชุฎุฏุงู ุงููุงุด)
// =========================================================
    const openChatbotBtn = document.getElementById('open-chatbot');
    const closeChatbotBtn = document.getElementById('close-chatbot');
    const chatbotContainer = document.getElementById('chatbot-container');
    const chatbotBody = document.getElementById('chatbot-body');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    
    // ๐ก ุฌุฏูุฏ: ูุงุฆู ุงูุชุฎุฒูู ุงููุคูุช ูุฑุฏูุฏ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุดุงุฆุนุฉ
    const aiResponseCache = {}; 
    
    function toggleSendButton() {
        sendBtn.disabled = userInput.value.trim() === '';
        sendBtn.style.backgroundColor = sendBtn.disabled ? '#555' : 'var(--primary-color)';
    }

    openChatbotBtn.addEventListener('click', () => {
        chatbotContainer.style.display = 'flex';
        openChatbotBtn.style.display = 'none';
        userInput.focus();
        toggleSendButton();
    });

    closeChatbotBtn.addEventListener('click', () => {
        chatbotContainer.style.display = 'none';
        openChatbotBtn.style.display = 'flex';
    });

    userInput.addEventListener('input', toggleSendButton);

    function addMessage(text, sender) {
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('message', `${sender}-message`);
        msgDiv.textContent = text;
        chatbotBody.prepend(msgDiv);
    }

    function showTypingIndicator() {
        const indicator = document.createElement('div');
        indicator.classList.add('typing-indicator');
        indicator.id = 'typing-indicator';
        indicator.innerHTML = '<span>.</span><span>.</span><span>.</span>';
        chatbotBody.prepend(indicator);
    }
    function hideTypingIndicator() { const ind = document.getElementById('typing-indicator'); if (ind) ind.remove(); }

    async function sendMessage() {
        const message = userInput.value.trim();
        if (!message) return;
        
        // ๐ ุงูุฎุทูุฉ 1: ุงูุชุญูู ูู ุงูุชุฎุฒูู ุงููุคูุช (ูุชุญููู ุณุฑุนุฉ ููุฑูุฉ)
        if (aiResponseCache[message]) {
            addMessage(message, 'user'); 
            userInput.value = '';
            toggleSendButton();
            addMessage(aiResponseCache[message], 'ai'); // ุงูุฑุฏ ููุฑู ูู ุงููุงุด
            playNotificationSound();
            return; // ุฅููุงุก ุงูุฏุงูุฉ ูุชุฌูุจ ุทูุจ ุงูุดุจูุฉ
        }
        
        addMessage(message, 'user');
        userInput.value = '';
        toggleSendButton();
        showTypingIndicator();

        try {
            const res = await fetch("https://mrk-shop.bouzidiabdou131.workers.dev/", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ prompt: message })
            });
            const data = await res.json();
            
            // ๐ ุงูุฎุทูุฉ 2: ุชุฎุฒูู ุงูุฑุฏ ุงูุฌุฏูุฏ ูู ุงููุงุด
            if (data.response) {
                aiResponseCache[message] = data.response;
            }
            
            hideTypingIndicator();
            addMessage(data.response || "โ๏ธ ูู ูุตู ุงูุฑุฏ.", 'ai');
            playNotificationSound();
        } catch (err) {
            hideTypingIndicator();
            addMessage("โ๏ธ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุงุชุตุงู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู.", 'ai');
            console.error(err);
        }
    }

    sendBtn.addEventListener('click', sendMessage);
    userInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !sendBtn.disabled) sendMessage();
    });

    function playNotificationSound() {
        const audio = new Audio('notification.mp3');
        audio.play();
    }
    // =========================================================
    // 10. Scroll Reveal
    // =========================================================
    document.querySelectorAll('.animate-on-scroll').forEach(section => {
        new IntersectionObserver((entries, observer)=>{
            entries.forEach(entry => {
                if(entry.isIntersecting){ entry.target.classList.add('visible'); observer.unobserve(entry.target); }
            });
        }, { threshold: 0.15 }).observe(section);
    });
// =========================================================
    // 12. Application Form Modal (Multi-Step) & Discord Webhook
    // (ููุญุฏููุซ: ูุตู ููุฒุฑููู/ุขูุฏู ุงูุฏูุณููุฑุฏุ ูุฅุถุงูุฉ ุฃุณุฆูุฉ ูุชุงุจูุฉุ ูููุดู)
    // =========================================================

    // โ๏ธ ุชู ุฅุฏุฎุงู ุฑุงุจุท ุงูู Webhook ุงูุฎุงุต ุจู
    const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1440759768955486250/1Qu6kGBebpX8DJfgWSQbYE_Fg7x9srOoVjwz30Gav0ZJTI0GFm1SrXgyd3aUBT0uCuhO'; 

    const appModal = document.getElementById('applicationModal');
    const closeAppBtn = document.getElementById('closeApplicationModal');
    const applicationForm = document.getElementById('submission-form');
    const appSubmitBtn = document.getElementById('submit-app-btn');
    const formTitle = document.getElementById('form-title');
    const factionNameInput = document.getElementById('faction-name');
    const formMessage = document.getElementById('form-message');
    const formError = document.getElementById('form-error');

    const step1 = document.getElementById('step-1');
    const step2 = document.getElementById('step-2');
    const nextStepBtn = document.getElementById('next-step-btn');
    const prevStepBtn2 = document.getElementById('prev-step-btn-2'); 

    let currentStep = 1;
    
    // ูุธููุฉ ูุชุญุฏูุฏ ููู ูุตูุฑุฉ ุงูู Embed ุจูุงุกู ุนูู ุงุณู ุงููุทุงุน
    function getFactionDetails(factionName) {
        let color, thumbnail;

        // ๐ผ๏ธ ููุงุญุธุฉ: ูุฌุจ ุฃู ุชุณุชุจุฏู ุงูุฑูุงุจุท ุฃุฏูุงู ุจุงูุฑูุงุจุท ุงููุจุงุดุฑุฉ ูุตูุฑู ุงูุฎุงุตุฉ
        const URL_FACTION_SECURITY = 'https://i.top4top.io/p_36104a0ey1.png';
        const URL_SERVICE_GOV = 'https://i.top4top.io/p_36104a0ey1.png';
        const URL_ROYAL_VIP = 'https://i.top4top.io/p_36104a0ey1.png';
        const URL_DEFAULT_LOGO = 'https://e.top4top.io/p_3610o7f621.png'; // ุฑุงุจุท ุดุนุงุฑ ุงูุณูุฑูุฑ ุงูุงูุชุฑุงุถู

        if (factionName.includes('ุงูุฏุงุฎููุฉ') || factionName.includes('ุงูุชุญูููุงุช') || factionName.includes('ุงูุฌูุงุฑู')) {
            color = '#E91E63'; 
            thumbnail = URL_FACTION_SECURITY;
        } else if (factionName.includes('ุงูุตุญุฉ') || factionName.includes('ุงูุทูุฑุงู') || factionName.includes('ุงูุตูุงูุฉ') || factionName.includes('ุงูุฏูุงุน')) {
            color = '#00BCD4'; 
            thumbnail = URL_SERVICE_GOV;
        } else if (factionName.includes('ุงูุฏููุงู ุงููููู')) {
            color = '#FFD700'; 
            thumbnail = URL_ROYAL_VIP;
        } else {
            color = '#007bff';
            thumbnail = URL_DEFAULT_LOGO; 
        }

        const discordColor = parseInt(color.substring(1), 16); 
        return { discordColor, thumbnail };
    }


    // --- 1. ููุทู ูุชุญ ูููุฐุฌ ุงูุชูุฏูู ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ูุฏูู ุงูุขู" ---
    document.querySelectorAll('.app-card .btn-primary').forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            const card = this.closest('.app-card');
            const faction = card.querySelector('h4').textContent.trim();
            
            formTitle.textContent = `ุชูุฏูู ุทูุจ ุงูุถูุงู ุฅูู ูุทุงุน ${faction}`;
            factionNameInput.value = faction;
            
            // ุฅุนุงุฏุฉ ุถุจุท ุงููููุฐุฌ ูุงูุฑุณุงุฆู ูุงููุฑุงุญู
            applicationForm.reset();
            applicationForm.classList.remove('hidden');
            formMessage.classList.add('hidden');
            formError.classList.add('hidden');
            currentStep = 1;
            step1.classList.remove('hidden');
            step2.classList.add('hidden');
            
            appModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        });
    });

    // --- 2. ููุทู ุงูุชููู ุจูู ุงููุฑุงุญู ูุงูุชุญูู ูู ุงูุญููู ุงููุทููุจุฉ ---
    
    // ุงูุงูุชูุงู ูู ุงููุฑุญูุฉ 1 (ุงูุจูุงูุงุช) ุฅูู 2 (ุงูููุงููู)
    nextStepBtn.addEventListener('click', () => {
        // ุงูุชุญูู ูู ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูู ุงููุฑุญูุฉ 1
        const step1Inputs = step1.querySelectorAll('[required]');
        let step1Valid = true;
        step1Inputs.forEach(input => {
            if (!input.value.trim()) { // ุงุณุชุฎุฏุงู trim ููุชุญูู ูู ุงููุฑุงุบุงุช
                step1Valid = false;
                input.focus();
            }
        });

        if (step1Valid) {
            currentStep = 2;
            step1.classList.add('hidden');
            step2.classList.remove('hidden');
        } else {
             alert("ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูู ุงููุฑุญูุฉ ุงูุฃููู.");
        }
    });

    // ุงูุนูุฏุฉ ูู ุงููุฑุญูุฉ 2 ุฅูู 1
    prevStepBtn2.addEventListener('click', () => {
        currentStep = 1;
        step1.classList.remove('hidden');
        step2.classList.add('hidden');
    });

    // ููุทู ุฅุบูุงู ุงููููุฐุฌ (ูุจูู ููุง ูู)
    closeAppBtn.onclick = () => {
        appModal.classList.remove('show');
        document.body.style.overflow = 'auto';
    };
    window.onclick = (event) => {
        if (event.target == appModal) {
            appModal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
    };


    // --- 3. ููุทู ุฅุฑุณุงู ุงูุจูุงูุงุช ุฅูู ุงูุฏูุณููุฑุฏ (Submit) ---
    applicationForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // ุงูุชุญูู ูู ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ ูุฃุณุฆูุฉ ุงูุฎูุงุฑุงุช ุงููุชุนุฏุฏุฉ
        const q1Correct = document.getElementById('q1-b').checked; 
        const q2Correct = document.getElementById('q2-b').checked; // ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุชู ุชุบููุฑูุง ูู PK
        const q3Correct = document.getElementById('q3-c').checked; // ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุชู ุชุบููุฑูุง ูู VDM
        const acknowledged = document.getElementById('acknowledgement').checked;

        // ุงูุชุญูู ูู ุฃู ุญููู ุงูุฅุฌุงุจุงุช ุงููุตูุฉ ููุณุช ูุงุฑุบุฉ
        const q4Text = document.getElementById('q4-text').value.trim();
        const q5Text = document.getElementById('q5-text').value.trim();

        if (!q1Correct || !q2Correct || !q3Correct || !acknowledged || !q4Text || !q5Text) {
            formError.textContent = 'โ ูุฌุจ ุงูุฅุฌุงุจุฉ ุนูู ุฌููุน ุฃุณุฆูุฉ ุงูููุงููู (ุงูุฎูุงุฑุงุช ูุงููุชุงุจูุฉ) ุจุดูู ุตุญูุญ ูุงูุชุนูุฏ ูุจู ุงูุฅุฑุณุงู.';
            formError.classList.remove('hidden');
            return; 
        }

        // ุฅุธูุงุฑ ุญุงูุฉ ุงูุชุญููู
        appSubmitBtn.textContent = 'ุฌุงุฑู ุงูุฅุฑุณุงู...';
        appSubmitBtn.disabled = true;
        formError.classList.add('hidden');
        
        const data = {
            faction: factionNameInput.value,
            discordUsername: document.getElementById('discord-username').value,
            discordUserID: document.getElementById('discord-user-id').value,
            inGame: document.getElementById('in-game-name').value,
            rpExp: document.getElementById('rp-question').value,
            whyJoin: document.getElementById('why-join').value,
            q4Answer: q4Text, // ุงูุฅุฌุงุจุฉ ุงููุตูุฉ ุงูุฃููู
            q5Answer: q5Text  // ุงูุฅุฌุงุจุฉ ุงููุตูุฉ ุงูุซุงููุฉ
        };

        const details = getFactionDetails(data.faction); // ุงูุญุตูู ุนูู ุงูููู ูุงูุตูุฑุฉ

        // **ุฅูุดุงุก ุงูููุดู (Mention) ููุฑุณู ุฅูู ุงูุฏูุณููุฑุฏ**
        const discordMention = `<@${data.discordUserID}>`;

        // ุชุฌููุฒ ุจูุงูุงุช Webhook ุจุชูุณูู ุงุญุชุฑุงูู
        const payload = {
            username: "ูุฏูุฑ ุงููุจูู | THE EAST", 
            avatar_url: details.thumbnail, 

            embeds: [{
                title: `๐ข ุทูุจ ุงูุถูุงู ุฌุฏูุฏ: ${data.faction}`,
                description: `**@ููุดู:** ${discordMention}\n\n**ูุฌุจ ุนูู ุงููุดุฑููู ูุฑุงุฌุนุฉ ุงูุทูุจ ุงูุขู ูุงูุชุญูู ูู ุงูุขูุฏู.**`,
                color: details.discordColor, 
                
                thumbnail: {
                    url: details.thumbnail 
                },
                
                fields: [
                    // ุญููู ููุธูุฉ ูููุณูุฉ 
                    { name: "๐ก๏ธ ุงุณู ุงููุณุชุฎุฏู (Discord)", value: `\`${data.discordUsername}\``, inline: true },
                    { name: "๐ค ุงุณู ุงููุงุนุจ (In-Game)", value: `\`${data.inGame}\``, inline: true },
                    { name: "๐ ุขูุฏู ุงูุฏูุณููุฑุฏ (ูุชุฃููุฏ ุงูููุดู)", value: `\`${data.discordUserID}\``, inline: false },
                    
                    { name: "------------------------------------------------", value: " ", inline: false }, // ูุงุตู

                    { name: "โ ุญุงูุฉ ุงุฎุชุจุงุฑ ุงูููุงููู", value: "**ูุงุฌุญ ูู ุงุฎุชุจุงุฑ ุงูุฎูุงุฑุงุชุ ุชู ุงูุชุญูู ูู ุงูุฅุฌุงุจุงุช ุงููุตูุฉ.**", inline: false },

                    { name: "๐ฏ ุณุจุจ ุงูุงูุถูุงู ูููุทุงุน", value: data.whyJoin.substring(0, 1024), inline: false },
                    
                    { name: "โ ุณ 4: ุฃูุซูุฉ ุนูู PG", value: data.q4Answer.substring(0, 1024), inline: false },
                    
                    { name: "โ ุณ 5: ุฅุฌุฑุงุกุงุช LTA", value: data.q5Answer.substring(0, 1024), inline: false }
                ],
                footer: { 
                    text: `ุชู ุงูุฅุฑุณุงู ุจูุงุณุทุฉ: ${data.discordUsername} | ${new Date().toLocaleDateString('ar-EG')}`,
                    icon_url: details.thumbnail 
                },
                timestamp: new Date().toISOString()
            }]
        };

        try {
            const response = await fetch(DISCORD_WEBHOOK_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (response.ok) {
                applicationForm.classList.add('hidden');
                formMessage.classList.remove('hidden');
                
            } else {
                throw new Error(`Discord API responded with status ${response.status}`);
            }
        } catch (error) {
            console.error('Submission Error:', error);
            formError.textContent = 'โ ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุฏูุณููุฑุฏ. ูุฑุฌู ูุฑุงุฌุนุฉ ุงูุฅุฏุงุฑุฉ.';
            formError.classList.remove('hidden'); 
        } finally {
            // ุฅุนุงุฏุฉ ุงูุฒุฑ ููุถุนู ุงูุฃุตูู
            appSubmitBtn.textContent = 'ุฅุฑุณุงู ุงูุทูุจ ุงูููุงุฆู';
            appSubmitBtn.disabled = false;
        }
    });
    // ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ููุชุญ ูุงูุฐุฉ ุงููุตุฉ ูุนุฑุถ ุงููุญุชูู
function displayStory(storyKey) {
    const story = allStoryData[storyKey];
    if (story) {
        // ุจูุงุก ูุญุชูู ุงููุงูุฐุฉ ุงูููุจุซูุฉ: ุงูุตูุฑุฉ + ุงููุญุชูู ุงูุทููู
        const fullContentHTML = `
            ${story.image ? `<img src="${story.image}" alt="${story.title}" class="modal-story-image">` : ''}
            <div class="modal-story-text">
                ${story.content}
            </div>
        `;
        storyBody.innerHTML = fullContentHTML;
    } else {
        storyBody.innerHTML = '<h1>ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุตุฉ ุงููุทููุจุฉ.</h1>';
    }
    
    // ุฅุบูุงู ูุงูุฐุฉ ูุงุฆูุฉ ุงููุตุต ูุจู ูุชุญ ุงููุตุฉ ุงูุฃุตููุฉ
    if (allStoriesModal && allStoriesModal.classList.contains('show')) {
        allStoriesModal.classList.remove('show');
    }
    
    storyModal.classList.add('show');
    document.body.style.overflow = 'hidden';
}
// =========================================================
// 8. ุชุดุบูู ุงูููุณููู ูุงูุชุญูู ูู ุงูุตูุช (Music Player)
// =========================================================
const audio = document.getElementById('background-audio'); 
const musicBtn = document.getElementById('music-btn');
const musicIcon = musicBtn ? musicBtn.querySelector('i') : null;
const musicSlider = document.getElementById('music-slider');

let isMusicPlaying = false; 

if (audio && musicBtn && musicIcon && musicSlider) {
    
    // ุงููุธููุฉ ุงููุณุคููุฉ ุนู ุชุญุฏูุซ ุงูุตูุช ูุชูููู ุดุฑูุท ุงูุชุญูู (ุชุตุญุญ ูุดููุฉ ุงูุงูุนูุงุณ)
    const updateSliderFill = () => {
        const value = parseFloat(musicSlider.value);
        
        // 1. ุชุญุฏูุซ ูุณุชูู ุงูุตูุช ุงููุนูู
        audio.volume = value / 100;
        
        // 2. ุชุญุฏูุซ ููู ุงูุฎูููุฉ (ุงูุชุนุจุฆุฉ) ุจุดูู ุฏููุงูููู
        const fillPercentage = `${value}%`;
        // ูุฐุง ุงูุณุทุฑ ูููุฃ ุงูุดุฑูุท ูู ุงููุณุงุฑ (0%) ุฅูู ุงููููู (100%) ุจุงูููู ุงูุฃุฒุฑู
        musicSlider.style.background = `linear-gradient(to right, var(--accent-color) ${fillPercentage}, #555 ${fillPercentage})`;
    };
    
    // 1. ุชุนููู ุงููููุฉ ุงูุฃูููุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ (ูุฅุธูุงุฑ ุงูููู ุงูุตุญูุญ)
    updateSliderFill(); 

    // 2. ููุทู ุฒุฑ ุงูุชุดุบูู ูุงูุฅููุงู
    musicBtn.addEventListener('click', () => {
        if (isMusicPlaying) {
            audio.pause();
            musicIcon.classList.remove('fa-volume-up'); 
            musicIcon.classList.add('fa-music'); 
            isMusicPlaying = false;
        } else {
            audio.play().then(() => {
                musicIcon.classList.remove('fa-music');
                musicIcon.classList.add('fa-volume-up');
                isMusicPlaying = true;
            }).catch(error => {
                console.error("Music playback error:", error);
                alert("โ๏ธ ูุดู ุงูุชุดุบูู. ูุฑุฌู ุงูุชุฃูุฏ ูู ูุณุงุฑ ุงูููู.");
            });
        }
    });
    
    // 3. ุฑุจุท ุญุฏุซ ุงูุฅุฏุฎุงู ูุชุญุฏูุซ ุงูุตูุช ูุงูููู ูุนุงู
    musicSlider.addEventListener('input', updateSliderFill);
    
    // 4. ุชุญุฏูุซ ุงูุฃููููุฉ ุนูุฏ ุชููู ุงูุชุดุบูู
    audio.addEventListener('pause', () => {
        isMusicPlaying = false;
        musicIcon.classList.remove('fa-volume-up');
        musicIcon.classList.add('fa-music');
    });
    
} else {
    console.error("ุนูุงุตุฑ ูุดุบู ุงูููุณููู ุบูุฑ ููุชููุฉ ูู HTML.");
}
// =========================================================
    // 13. Membership Benefits Logic (ููุทู ูุงูุฐุฉ ุงููููุฒุงุช)
    // =========================================================

    // ูุงุนุฏุฉ ุจูุงูุงุช ุงููููุฒุงุช (ููููู ุชุนุฏูู ุงููุตูุต ุญุณุจ ุณูุฑูุฑู)
    const membershipData = {
        'silver': {
            title: 'SILVER Membership',
            price: '$4.00',
            color: '#C0C0C0',
            features: [
                'ุฑุงุชุจ ุดูุฑู ุฅุถุงูู (2000$)',
                'ุฃููููุฉ ูู ุทุงุจูุฑ ุงูุฏุฎูู (Queue Priority)',
                'ุณูุงุฑุฉ ุญุตุฑูุฉ ูู ูุฆุฉ Silver',
                'ุฎุตู 5% ูู ูุชุงุฌุฑ ุงูุฃุณูุญุฉ',
                'ุชุบููุฑ ุฑูู ุงููุงุชู ูุฑุฉ ูุงุญุฏุฉ ูุฌุงูุงู'
            ]
        },
        'platinum': {
            title: 'PLATINUM Membership',
            price: '$7.00',
            color: '#8A2BE2', // ุจููุณุฌู
            features: [
                'ูู ูููุฒุงุช ุจุงูุฉ Silver',
                'ุฑุงุชุจ ุดูุฑู ุฅุถุงูู (5000$)',
                'ููุฒู ูุฌุงูู ูุชูุณุท ูู ุงููุฏููุฉ',
                'ุณูุงุฑุฉ ุฑูุงุถูุฉ ุญุตุฑูุฉ Platinum',
                'ููุญุฉ ุณูุงุฑุฉ ูููุฒุฉ ูุฎุตุตุฉ (Custom Plate)',
                'ุฎุตู 10% ูู ุงููุฑุด ููุชุงุฌุฑ ุงูุณูุงุฑุงุช'
            ]
        },
        'vip': {
            title: 'VIP Membership',
            price: '$12.00',
            color: '#FFD700', // ุฐูุจู
            features: [
                'ูู ูููุฒุงุช ุงูุจุงูุงุช ุงูุณุงุจูุฉ',
                'ุฑุงุชุจ ุดูุฑู ุฅุถุงูู (10,000$)',
                'ูุตุฑ ูุงุฎุฑ ูู ููุทูุฉ Vinewood',
                'ุทุงุฆุฑุฉ ูููููุจุชุฑ ุฎุงุตุฉ',
                'ุฅูุดุงุก ุดุฑูุฉ ุฎุงุตุฉ ูุฌุงูุงู',
                'ูุตูู ุญุตุฑู ููุงุฆูุฉ VIP Menu',
                'ุฏุนู ููู ูุจุงุดุฑ ูุณุฑูุน'
            ]
        }
    };

    const benefitsModal = document.getElementById('benefitsModal');
    const benefitsContent = document.getElementById('benefits-content');
    const closeBenefitsBtn = document.getElementById('closeBenefitsModal');

    // ุชูุนูู ุงูุฃุฒุฑุงุฑ ุนูุฏ ุงูุถุบุท ุนูููุง
    document.querySelectorAll('.view-benefits-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            // ููุน ุงูุชุดุงุฑ ุงูุญุฏุซ ููุนูุงุตุฑ ุงูุฃุจ (ุฅุฐุง ูุฒู ุงูุฃูุฑ)
            e.stopPropagation();

            const type = this.getAttribute('data-membership');
            const data = membershipData[type];

            if (data) {
                // 1. ุจูุงุก ูุงุฆูุฉ ุงููููุฒุงุช
                let featuresHTML = '<ul class="benefits-list">';
                data.features.forEach(feature => {
                    featuresHTML += `<li><i class="fas fa-check-circle"></i> ${feature}</li>`;
                });
                featuresHTML += '</ul>';

                // 2. ุชุฌููุน ูุญุชูู ุงููุงูุฐุฉ
                const modalHTML = `
                    <div class="benefits-header">
                        <h2 style="color: ${data.color}; margin-bottom: 5px;">${data.title}</h2>
                        <div class="benefits-price">${data.price}</div>
                    </div>
                    ${featuresHTML}
                    <div class="text-center mt-4">
                        <a href="https://discord.gg/3Sbx3xb68T" target="_blank" class="btn btn-primary" style="width: 100%;">
                            <i class="fab fa-discord"></i> ุดุฑุงุก ุงูุขู ุนุจุฑ ุงูุฏูุณููุฑุฏ
                        </a>
                    </div>
                `;

                // 3. ุนุฑุถ ุงููุงูุฐุฉ
                benefitsContent.innerHTML = modalHTML;
                benefitsModal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
        });
    });

    // ุฅุบูุงู ุงููุงูุฐุฉ ูู ุฒุฑ X
    if (closeBenefitsBtn) {
        closeBenefitsBtn.addEventListener('click', () => {
            benefitsModal.classList.remove('show');
            document.body.style.overflow = 'auto';
        });
    }

    // ุฅุบูุงู ุงููุงูุฐุฉ ุนูุฏ ุงูุถุบุท ุฎุงุฑุฌูุง
    window.addEventListener('click', (event) => {
        if (event.target == benefitsModal) {
            benefitsModal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
    });
    // =========================================================
    // 14. 3D Map Modal Logic (Load map3d.html content)
    // =========================================================

    const map3dModal = document.getElementById('map3dModal');
    const openMap3dBtn = document.getElementById('openMap3dModalBtn');
    const closeMap3dBtn = document.getElementById('closeMap3dModal');
    const map3dContainer = document.getElementById('map3dContentContainer');
    let map3dContentLoaded = false; 
    let animationFrameId = null; // ูุชุฎุฒูู ูุนุฑู ุญููุฉ ุงูุฑุณูู ุงููุชุญุฑูุฉ

    // ุฏุงูุฉ ูุฌูุจ ูุญุชูู map3d.html ูุชูููุฐ ุฃููุงุฏู
    function loadMap3dContent() {
        if (map3dContentLoaded) {
            // ุฅุฐุง ูุงู ุงููุญุชูู ูุญููุงู ูุณุจูุงูุ ููุชูู ุจุฅุนุงุฏุฉ ุชุดุบูู ุงูุฑุณูู ุงููุชุญุฑูุฉ
            if (typeof window.animate === 'function') {
                window.animate(); // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุงูุนุงูุฉ ููุญุฑูุฉ
            }
            return;
        }

        // ุฅุธูุงุฑ ุฑุณุงูุฉ ุงูุชุญููู
        map3dContainer.innerHTML = '<div style="text-align: center; padding: 50px; color: white; font-size: 1.5rem;">ุฌุงุฑู ุชุญููู ุงูุฎุฑูุทุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ...</div>';

        fetch('map3d.html')
            .then(response => response.text())
            .then(html => {
                // ุงุณุชุฎุฏุงู DOMParser ูุชุญููู ูุญุชูู ุงูุตูุญุฉ ุงููุฌููุจุฉ
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // ุงุณุชุฎุฑุงุฌ ูุญุชูู ุฌุณู ุงูุตูุญุฉ
                const bodyContent = doc.body.innerHTML; 
                map3dContainer.innerHTML = bodyContent; 
                
                // ุฅุนุงุฏุฉ ุชูููุฐ ุฃููุงุฏ ุฌุงูุงุณูุฑูุจุช (ููู ุฌุฏุงู ูุชุดุบูู Three.js)
                map3dContainer.querySelectorAll('script').forEach(oldScript => {
                    if (oldScript.type === 'module') {
                        // ุฅูุดุงุก ูุณู ุณูุฑูุจุช ุฌุฏูุฏ
                        const newScript = document.createElement('script');
                        newScript.type = 'module';
                        // ูุณุฎ ุงููุญุชูู
                        newScript.textContent = oldScript.textContent;
                        // ุฅุนุงุฏุฉ ุฅุฏุฎุงู ุงููุณู ูุชุดุบููู
                        map3dContainer.appendChild(newScript);
                    }
                });
                
                map3dContentLoaded = true;
            })
            .catch(err => {
                console.error('Failed to load map3d.html:', err);
                map3dContainer.innerHTML = '<div style="text-align: center; padding: 50px; color: red; font-size: 1.5rem;">โ ูุดู ุชุญููู ุงูุฎุฑูุทุฉ. ุชุฃูุฏ ูู ูุฌูุฏ ุงููููุงุช ุงููุงุฒูุฉ.</div>';
            });
    }

    // ูุชุญ ุงููุงูุฐุฉ
    if (openMap3dBtn) {
        openMap3dBtn.addEventListener('click', () => {
            loadMap3dContent(); 
            map3dModal.classList.add('show');
            document.body.style.overflow = 'hidden'; // ููุน ุงูุชูุฑูุฑ ูู ุงูุฎูููุฉ
        });
    }

    // ุฅุบูุงู ุงููุงูุฐุฉ
    if (closeMap3dBtn) {
        closeMap3dBtn.addEventListener('click', () => {
            map3dModal.classList.remove('show');
            document.body.style.overflow = 'auto';

            // ุฅููุงู ุญููุฉ ุงูุฑุณูู ุงููุชุญุฑูุฉ (animate loop) ูุชูููุฑ ููุงุฑุฏ ุงูุฌูุงุฒ
            if (typeof window.cancelAnimationFrame === 'function' && window.animationFrameId) {
                window.cancelAnimationFrame(window.animationFrameId);
                // ุชุนููู ุงููุชุบูุฑ ูู null ูููุน ุงูุงุณุชุฏุนุงุกุงุช ุงููุณุชูุจููุฉ ุบูุฑ ุงููุฑุบูุจ ูููุง
                window.animationFrameId = null; 
            }
        });
    }

    // ุงูุฅุบูุงู ุนูุฏ ุงูููุฑ ุฎุงุฑุฌ ุงููุงูุฐุฉ
    window.addEventListener('click', (event) => {
        if (event.target == map3dModal) {
            map3dModal.classList.remove('show');
            document.body.style.overflow = 'auto';
            
            if (typeof window.cancelAnimationFrame === 'function' && window.animationFrameId) {
                window.cancelAnimationFrame(window.animationFrameId);
                window.animationFrameId = null;
            }
        }
    });
    // ูู ููู script.js - ุงุณุชุจุฏู ุงูุฏุงูุฉ initializeInteractiveMap() ุจุงููุงูู ุจูุฐุง ุงูููุฏ

// ูู ููู script.js - ุงุณุชุจุฏู ุงูุฏุงูุฉ initializeInteractiveMap() ุจุงููุงูู ุจูุฐุง ุงูููุฏ

// =========================================================
// 4. ุฎุฑูุทุฉ Leaflet ุงูุชูุงุนููุฉ - ูุฑุงูุฒ LA ููุท (ุงููุดูู ูุงูุดุฑุทุฉ)
// =========================================================
function initializeInteractiveMap() {
    const mapContainer = document.getElementById('leaflet-map-container');
    const staticMap = document.querySelector('.static-map');

    if (typeof L === 'undefined' || !mapContainer) {
        if (staticMap) {
            staticMap.style.display = 'block';
        }
        return;
    }

    if (staticMap) {
        staticMap.style.display = 'none';
    }

    // ุงูุฃุจุนุงุฏ: ูุฐู ููู ุชูุฏูุฑูุฉ (2000x2000). 
    // ูุฑุฌู ุชุนุฏูููุง ุจูุงุกู ุนูู ุงูุนุฑุถ ูุงูุงุฑุชูุงุน ุงููุนูููู ูู image_2a261d.jpg
    const imageWidth = 2000;  
    const imageHeight = 2000; 
    const bounds = [[0, 0], [imageHeight, imageWidth]]; 

    // 1. ุฅูุดุงุก ุงูุฎุฑูุทุฉ
    const map = L.map('leaflet-map-container', {
        crs: L.CRS.Simple,
        minZoom: -1,
        maxZoom: 3,
        zoom: 0,
        center: [imageHeight / 2, imageWidth / 2],
        maxBounds: bounds,
        maxBoundsViscosity: 1.0, 
        attributionControl: false,
        scrollWheelZoom: true, // ุชูุนูู ุงูุชูุจูุฑ ูุงูุชุตุบูุฑ ุจุนุฌูุฉ ุงููุงูุณ
        dragging: true,        // ุชูุนูู ุงูุชุญุฑูู
    });

    // 2. ุฅุถุงูุฉ ุตูุฑุฉ ุงูุฎุฑูุทุฉ ุงูุฌุฏูุฏุฉ ูุทุจูุฉ
    // ุงุณู ุงูููู ุงูุฌุฏูุฏ ุงูุฐู ุฑูุนู ุงููุณุชุฎุฏู: image_2a261d.jpg
    L.imageOverlay('fullmap.jpg', bounds).addTo(map);
    
    // 3. ุชุนุฑูู ุฃููููุงุช ูุฎุตุตุฉ (ูุชููู ุจุงุฑุฒุฉ ูุฌูููุฉ)
    const CustomIcon = L.Icon.extend({
        options: {
            iconSize: [50, 50],
            iconAnchor: [25, 50], 
            popupAnchor: [0, -50] 
        }
    });

    // ุณูุณุชุฎุฏู ุฃููููุฉ ููุญุฏุฉ ูููุฑูุฒูู ูุชุณููู ุงูุฃูุฑ ููุฃู ูุฏูู ุตูุฑุฉ ps.jpg ู hos.jpg ูุฎุตุตุฉ ููู Popup
    // ูููู ุงุณุชุฎุฏุงู 'ps.jpg' ูุฃููููุฉ ูููุฑูุฒูู ูุฌุนููุง ูููุฒุฉ
    const centerIcon = new CustomIcon({ iconUrl: 'ps.jpg' }); 

    // 4. ุชุนุฑูู ุงููุฑุงูุฒ ุงููุทููุจุฉ (ููุทุชูู ููุท)
    // **ูุงู ุฌุฏุงู:** ุงูุฅุญุฏุงุซูุงุช ุงูุชุงููุฉ ูู ุชุฎููููุฉ ุฏุงุฎู ููุทูุฉ LA (ุงููุฏููุฉ ุงููุจูุฑุฉ ุฃุณูู ุงููุณุงุฑ).
    // ูุฑุฌู ุชุนุฏูููุง ูุชุชูุงุณุจ ูุน ุงูููุงูุน ุงูุฏูููุฉ ูููุฑูุฒูู ุนูู ุงูุฎุฑูุทุฉ ุงูุฌุฏูุฏุฉ:
    const centers = [
        { 
            latlng: [540  , 1390], // (Y, X) - ูููุน ููุฏุฑ ูููุณุชุดูู ูู ูุฏููุฉ LA
            title: '๐ฅ ูุณุชุดูู The East ุงููุฑูุฒู', 
            description: 'ููุทูุงุฑุฆ ูุงูุฎุฏูุงุช ุงูุทุจูุฉ ุนูู ูุฏุงุฑ ุงูุณุงุนุฉ.', 
            imageFile: 'hos.jpg', // ุงูุตูุฑุฉ ุงููุฑููุนุฉ ูููุดูู
            icon: centerIcon
        },
        { 
            latlng: [435, 1520], // (Y, X) - ูููุน ููุฏุฑ ููุฑูุฒ ุงูุดุฑุทุฉ ูู ูุฏููุฉ LA
            title: '๐ ูุฑูุฒ ุดุฑุทุฉ The East', 
            description: 'ุงููุฑูุฒ ุงูุฑุฆูุณู ููุญูุงูุฉ ูุงูุฃูู.', 
            imageFile: 'ps.jpg', // ุงูุตูุฑุฉ ุงููุฑููุนุฉ ููุดุฑุทุฉ
            icon: centerIcon
        }
    ];

    // 5. ุฅุถุงูุฉ ุงูุนูุงูุงุช (Markers) ุฅูู ุงูุฎุฑูุทุฉ
    centers.forEach(center => {
        const marker = L.marker(center.latlng, { icon: center.icon }).addTo(map);

        // ุฅูุดุงุก ูุญุชูู ุงูู Popup ุงูุฐู ูุญุชูู ุนูู ุงูุตูุฑุฉ ุงููุงุญุฏุฉ ุงููุทููุจุฉ
        const imagesHtml = `
            <div class="popup-images-container">
                <img src="${center.imageFile}" alt="${center.title}">
            </div>
        `;

        const popupContent = `
            <h3>${center.title}</h3>
            <p>${center.description}</p>
            ${imagesHtml}
        `;
        
        marker.bindPopup(popupContent, { 
            closeButton: true, 
            minWidth: 280,
            maxWidth: 350
        });
    });

    // 6. ุชูุนูู ุงูุชูุจูุฑ/ุงูุชุตุบูุฑ ูุงูุชุญุฑูู ุงูุงูุชุฑุงุถู
    map.fitBounds(bounds);
    map.setZoom(0);
}

// ุชุดุบูู ุฏุงูุฉ ุงูุฎุฑูุทุฉ ุจุนุฏ ุชุญููู DOM
initializeInteractiveMap();
// ... ุงูููุฏ ุงูุณุงุจู ...

/* =============================== */
/*        Car Slider Script        */
/* =============================== */

function scrollCars(direction) {
    const slider = document.getElementById("carStrip");

    // ููุฏุงุฑ ุงูุชูุฑูุฑ ูู ูู ุถุบุทุฉ
    const scrollAmount = slider.clientWidth * 0.6; 
    // ูุชุญุฑู ุชูุฑูุจุงู 60% ูู ุนุฑุถ ุงูุณูุงูุฏุฑ

    if (direction === "left") {
        slider.scrollLeft += scrollAmount;
    } else {
        slider.scrollLeft -= scrollAmount;
    }
}

/* ุณุญุจ ุจุงูุฅุตุจุน ูุงููุงูุณ (Professional Drag Support) */
let isDown = false;
let startX;
let scrollLeft;

const slider = document.getElementById("carStrip");

slider.addEventListener("mousedown", (e) => {
    isDown = true;
    slider.classList.add("active");
    startX = e.pageX - slider.offsetLeft;
    scrollLeft = slider.scrollLeft;
});

slider.addEventListener("mouseleave", () => {
    isDown = false;
    slider.classList.remove("active");
});

slider.addEventListener("mouseup", () => {
    isDown = false;
    slider.classList.remove("active");
});

slider.addEventListener("mousemove", (e) => {
    if (!isDown) return;
    e.preventDefault();
    const x = e.pageX - slider.offsetLeft;
    const walk = (x - startX) * 2; 
    slider.scrollLeft = scrollLeft - walk;
});

/* ูุฏุนู ุงูููุณ (ููุฌูุงู) */
slider.addEventListener("touchstart", (e) => {
    startX = e.touches[0].pageX;
    scrollLeft = slider.scrollLeft;
});

slider.addEventListener("touchmove", (e) => {
    const x = e.touches[0].pageX;
    const walk = (x - startX) * 1.8;
    slider.scrollLeft = scrollLeft - walk;
});

}); // end DOMContentLoaded